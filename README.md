My custom implementation of the Extended Kalman Filter algorithm for fusing gyroscope measurements with the accelerometer readings in the Intel RealSense D4 series cameras, for attitude estimation of the camera with respect to the first frame in which the node was started. The EKF prediction step uses the gyroscope measurements to predict the next state by integrating them. Two methods of integration have been implemented. A simple Euler integration method and the Runge-Kutta fourth order integration method. There are two ways of representing attitudes: Euler angles (roll,pitch and yaw) or Quaternions (qw,qx,qy,qz) (Hamilton convention). Both have been implemented in this package. Representing the states as Euler angles comes with the risk of Gimbal Lock being encountered internally, hence the shift to a quaternion based representation, which is standard in all estimation algorithms. Roll and Pitch estimations are quite accuarate and robust to drift. The same cannot be said for yaw however, as the accelerometer cannot provide any information about the yaw, and hence the estimator is forced to rely on only the noisy gyroscope measurements.
